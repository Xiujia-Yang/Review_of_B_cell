# Review_of_B_cell
> [!NOTE]
> This repository hosts the codes and intermediate results used to produce the key results in our research article, "Single-cell analysis reveals multi-faceted features of B cell development together with age-associated B cell subpopulations".

## Table of contents
* [Introduction of the codes](#Introduction-of-the-codes)
* [Introduction of the intermediate results](#Introduction-of-the-intermediate-results)


## Introduction of the codes

We organize our codes (either R or Python script) according to their applications. Generally, they fall into the following six categories,

1. [Data preprocessing and cell population identification](https://github.com/Xiujia-Yang/Review_of_B_cell/tree/main/1_Data_prep_and_cell_ident)
	- RScript: DoubletFinder
	- RScript: Primary clustering & B cell secondary clustering

2. [Gene regulation dynamics](https://github.com/Xiujia-Yang/Review_of_B_cell/tree/main/2_Gene_regulation_dynamics)
	- Python: scVelo analysis 

3. [Trajectory inference](https://github.com/Xiujia-Yang/Review_of_B_cell/tree/main/3_Trajectory_inference)
	- RScript: Monocle2 analysis

4. [BCR repertoire analysis](https://github.com/Xiujia-Yang/Review_of_B_cell/tree/main/4_BCR_repertoire_analysis)
	- Python: BCR repertoire analysis

5. [Cell communication analysis](https://github.com/Xiujia-Yang/Review_of_B_cell/tree/main/5_Cell_communication_analysis)
	- Python: CellPhoneDb analysis

6. [External data investigation](https://github.com/Xiujia-Yang/Review_of_B_cell/tree/main/6_External_data_investigation)
	- Rscript: Import data and preprocessing
	- Python: Customized scripts

## Introduction of the intermediate results

The following intermediate results can be used with the released codes to reproduce the key results in this study.

- `CellPhoneDB.tar.gz`: It stores all CCI prediction results generated by CellPhoneDB. CCI prediction in different tissue sources are seperately curated.
- `IgBLAST_parsed_combined.txt.gz`: This file records updated gene assignment information for BCR contigs. Exact V/D/J allele assignment was made for each contig for determination of SHM frequency.
- `adata_merge_obs_metadata.csv.gz`: This file stores cell metadata with velocity-based pseudotime prediction.
- `bc.proj.clean.clone.csv.gz`: This file stores assembled clonotype information for B cells in this study.
- `bc.proj.clean.metadata.csv.gz`: This file stores cell metadata. 
- `external_project_metadata.tar.gz`: It stores the cell metadata information for 6 external single-cell studies. Expression levels of genes of interest are also precomputed.
- `merged_filtered_contig_annotations_preprocessed.csv.gz`: This file stores the annotation of BCR contigs from all in-house enriched B cell samples. BCR contigs were preprocessed to retain only one valid heavy chain contig and one valid light chain contig for each cell.
- `rank_velocity_genes.csv`: This file stores genes with top velocity score for each B cell subpopulation.


## Others
If you have any questions related to these codes, please contact the authors through the following emails (zhenhaismu@163.com, yangxiuj1a@163.com).